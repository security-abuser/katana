/*  
    -- CONFIDENTIAL - SOURCE MATERIALS --
                                                                                                                                                                                                        
    THIS IS UNPUBLISHED PROPRIETARY SOURCE CODE.
    
    -- CONFIDENTIAL - SOURCE MATERIALS --

 */

#include "katana_exploit.h"
#include "module.h"
#include "katana_shell.h"
#include "./modules/core/exploit.h"


int 
run_exploit()
{
	struct exploit_params *params;

	if (current_exploit < 0 ) {
		printf("\n%s[!]%s no exploit set \n\n", _RED, _ENDC);
		return 0;
	}

	params = malloc(sizeof(struct exploit_params));

	params->target_host = target_host;
	params->connect_back_ip = connect_back_ip;

	modules[current_exploit].exploit(params);

	free(params);
}